-- TrÃ¡nh cháº¡y nhiá»u láº§n
if _G.MONITOR_15MIN_RUNNING1 then return end
_G.MONITOR_15MIN_RUNNING1 = true

local Players          = game:GetService("Players")
local ReplicatedStorage= game:GetService("ReplicatedStorage")
local RunService       = game:GetService("RunService")
local Save             = require(ReplicatedStorage.Library.Client.Save)

local player = Players.LocalPlayer

-- Láº¥y lÆ°á»£t Ä‘Ã£ dÃ¹ng (DailyRuns)
local function getRunsUsed()
    local sd = Save.Get()
    return (sd and sd.TimeTrialStats and sd.TimeTrialStats.DailyRuns) or 0
end

-- Láº¥y tá»•ng lÆ°á»£t (TotalRuns)
local function getTotalRuns()
    local sd = Save.Get()
    return (sd and sd.TimeTrialStats and sd.TimeTrialStats.TotalRuns) or 0
end

-- â±ï¸ Monitor 15 phÃºt dÃ¹ng Heartbeat
local function startMonitor15Min()
    local lastUsed  = getRunsUsed()
    local lastTotal = getTotalRuns()
    local timer     = 0
    local conn

    conn = RunService.Heartbeat:Connect(function(dt)
        -- Náº¿u Ä‘Ã£ Ä‘á»§ 10 lÆ°á»£t, dá»«ng luÃ´n
        if getRunsUsed() >= 10 then
            warn("ğŸ›‘ ÄÃ£ Ä‘á»§ 10 lÆ°á»£t â†’ dá»«ng theo dÃµi 15 phÃºt.")
            conn:Disconnect()
            return
        end

        -- cá»™ng dá»“n thá»i gian
        timer = timer + dt

        -- kiá»ƒm tra reset khi cÃ³ thay Ä‘á»•i
        local curUsed, curTotal = getRunsUsed(), getTotalRuns()
        if curUsed ~= lastUsed or curTotal ~= lastTotal then
            lastUsed, lastTotal = curUsed, curTotal
            timer = 0
            warn("ğŸ”„ Reset monitor15Min (ÄÃ£ Ä‘á»•i lÆ°á»£t/TotalRuns).")
        end

        -- náº¿u vÆ°á»£t quÃ¡ 900s = 15 phÃºt
        if timer >= 900 then
            warn("â° 15 phÃºt khÃ´ng Ä‘á»•i lÆ°á»£t hoáº·c TotalRuns â†’ Kick player.")
            conn:Disconnect()
            player:Kick("15 phÃºt khÃ´ng Ä‘á»•i lÆ°á»£t/TotalRuns â†’ nghi ngá» treo mÃ¡y.")
        end
    end)
end

-- start ngay
startMonitor15Min()
