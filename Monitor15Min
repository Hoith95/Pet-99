
-- Ch·ªâ theo d√µi 15 ph√∫t kh√¥ng tƒÉng l∆∞·ª£t/TotalRuns v√† kick

-- Thay th·∫ø ƒë∆∞·ªùng d·∫´n require ph√π h·ª£p v·ªõi d·ª± √°n c·ªßa b·∫°n
local Players          = game:GetService("Players")
local ReplicatedStorage= game:GetService("ReplicatedStorage")
local Save             = require(ReplicatedStorage.Library.Client.Save)

local player = Players.LocalPlayer

-- H√†m ti·ªán √≠ch l·∫•y l∆∞·ª£t ƒë√£ d√πng
local function getRunsUsed()
    local saveData = Save.Get()
    return (saveData and saveData.TimeTrialStats and saveData.TimeTrialStats.DailyRuns) or 0
end

-- H√†m ti·ªán √≠ch l·∫•y t·ªïng l∆∞·ª£t
local function getTotalRuns()
    local saveData = Save.Get()
    return (saveData and saveData.TimeTrialStats and saveData.TimeTrialStats.TotalRuns) or 0
end

-- ‚è±Ô∏è Monitor 12 ph√∫t kh√¥ng tƒÉng l∆∞·ª£t/TotalRuns
local function startMonitor12Min()
    local lastUsed  = getRunsUsed()
    local lastTotal = getTotalRuns()
    local timer     = 0

    task.spawn(function()
        while true do
            -- N·∫øu ƒë√£ ƒë·ªß 10 l∆∞·ª£t th√¨ d·ª´ng h·∫≥n
            if getRunsUsed() >= 10 then
                warn("üõë ƒê√£ ƒë·ªß 10 l∆∞·ª£t ‚Üí d·ª´ng theo d√µi 12 ph√∫t.")
                return
            end

            task.wait(10)
            timer = timer + 10

            local curUsed  = getRunsUsed()
            local curTotal = getTotalRuns()

            -- N·∫øu c√≥ thay ƒë·ªïi l∆∞·ª£t ho·∫∑c t·ªïng l∆∞·ª£t, reset timer
            if curUsed ~= lastUsed or curTotal ~= lastTotal then
                lastUsed  = curUsed
                lastTotal = curTotal
                timer     = 0
                warn("üîÑ Reset monitor12min do c√≥ ho·∫°t ƒë·ªông ƒë·ªïi l∆∞·ª£t/TotalRuns.")
            end

            -- N·∫øu v∆∞·ª£t qu√° 900 gi√¢y (12 ph√∫t) m√† kh√¥ng reset th√¨ kick
            if timer >= 900 then
                player:Kick("‚è∞ 15 ph√∫t kh√¥ng ƒë·ªïi l∆∞·ª£t ho·∫∑c TotalRuns ‚Üí nghi ng·ªù treo m√°y.")
                return
            end
        end
    end)
end

-- Kh·ªüi ch·∫°y monitor ngay khi require file n√†y
startMonitor15Min()
