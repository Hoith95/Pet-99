-- â–¶ï¸ Script Test: In káº¿t quáº£ tÃ¬m Tile & Egg â€œbestâ€

local Workspace         = game:GetService("Workspace")
local TilesFolder       = Workspace:WaitForChild("__THINGS"):WaitForChild("Tiles")
local CustomEggsFolder  = Workspace:WaitForChild("__THINGS"):WaitForChild("CustomEggs")

-- ğŸ”¢ Extract giÃ¡ trá»‹ â€œx Huge Luckâ€ tá»« text
local function extractHugeLuckValue(text)
    local num = text:match("(%d+)x%s+Huge%s+Luck")
    return tonumber(num) or 0
end

-- ğŸ§± TÃ¬m Tile cÃ³ â€œx Hugeâ€ cao nháº¥t
local function findBestTile()
    local bestTile, bestValue = nil, -1
    for _, tile in ipairs(TilesFolder:GetChildren()) do
        -- láº¥y Label chá»©a text â€œNx Huge Luckâ€
        local label = tile:FindFirstChild("Sign")
            and tile.Sign:FindFirstChild("SurfaceGui")
            and tile.Sign.SurfaceGui:FindFirstChild("Frame")
            and tile.Sign.SurfaceGui.Frame:FindFirstChild("Frame")
            and tile.Sign.SurfaceGui.Frame.Frame:FindFirstChild("TextLabel")
        if label and label:IsA("TextLabel") then
            local value = extractHugeLuckValue(label.Text)
            if value > bestValue then
                bestTile, bestValue = tile, value
            end
        end
    end

    if bestTile then
        print(string.format("ğŸ§± Best Tile: %s | %dx HUGE", bestTile.Name, bestValue))
    else
        warn("âŒ KhÃ´ng tÃ¬m tháº¥y báº¥t ká»³ Tile nÃ o cÃ³ â€˜x Hugeâ€™.")
    end

    return bestTile, bestValue
end

-- ğŸ¥š TÃ¬m Egg gáº§n Tile, Æ°u tiÃªn cÃ³ â€œslashesâ€
local function findBestEggNearTile(tile)
    if not tile or not tile.PrimaryPart then
        warn("âŒ Tile khÃ´ng há»£p lá»‡ Ä‘á»ƒ tÃ¬m Egg.")
        return nil
    end

    local function findClosest(filterFn)
        local closest, minDist = nil, math.huge
        for _, eggM in ipairs(CustomEggsFolder:GetChildren()) do
            local part = eggM:FindFirstChild("Part")
            if part and filterFn(eggM) then
                local dist = (part.Position - tile.PrimaryPart.Position).Magnitude
                if dist < minDist then
                    closest, minDist = eggM, dist
                end
            end
        end
        return closest
    end

    -- 1) thá»­ láº¥y egg cÃ³ slashes
    local eggWith = findClosest(function(e) return e:FindFirstChild("slashes") end)
    if eggWith then
        print(string.format("ğŸ¥š Best Egg: %s | âœ… CÃ“ 'slashes'", eggWith.Name))
        return eggWith
    end

    -- 2) fallback: láº¥y báº¥t ká»³ egg nÃ o
    local eggAny = findClosest(function() return true end)
    if eggAny then
        print(string.format("ğŸ¥š Fallback Egg: %s | âŒ KHÃ”NG 'slashes'", eggAny.Name))
        return eggAny
    end

    warn("âŒ KhÃ´ng tÃ¬m tháº¥y báº¥t ká»³ Egg nÃ o quanh Tile.")
    return nil
end

-- â–¶ï¸ Cháº¡y test
local tile, hugeValue = findBestTile()
local egg = findBestEggNearTile(tile)
