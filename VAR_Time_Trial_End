local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Save = require(ReplicatedStorage.Library.Client.Save)

local function getDailyRuns()
    local ok, sd = pcall(Save.Get)
    if not ok or not sd then return 0 end
    return (sd.TimeTrialStats and sd.TimeTrialStats.DailyRuns) or 0
end

local used = getDailyRuns()

if used >= 10 then
    _G.Time_Trial_End = true
    warn("✅ Đã đủ 10 lượt — _G.Time_Trial_End = true")

    task.delay(60, function()

        if _G.Time_Trial_Var ~= true then
            warn("⛔ Sau 60s vẫn chưa đổi ENCHANTS — kick")

            local player = Players.LocalPlayer
            if player then
                player:Kick(
                    "⛔ Time Trial đã kết thúc.\n" ..
                    "Sau 60 giây vẫn chưa đổi ENCHANTS.\n" ..
                    "Vui lòng đổi ENCHANTS trước khi chạy tiếp."
                )
            end
        else
            warn("✅ ENCHANTS đã được đổi trong 60s — cho phép tiếp tục.")
        end

    end)

else
    warn(("ℹ️ Hiện %d lượt — chưa đủ 10 lượt."):format(used))
end
