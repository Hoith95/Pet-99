if _G.TeleEventManager then
    warn("â›” Script Ä‘Ã£ Ä‘Æ°á»£c cháº¡y trÆ°á»›c Ä‘Ã³!")
    return
end
_G.TeleEventManager = true

-- âš™ï¸ Dá»‹ch vá»¥
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- ğŸŒ PlaceId
local PLACE_WORLD_4 = 140403681187145
local PLACE_FISHING = 95635359880599
local PLACE_FARM = 119454325063278

-- ğŸ“‚ Äá»c log comboEventLog.json
local function readComboLog()
    local success, data = pcall(readfile, "comboEventLog.json")
    if not success or not data then return nil end
    local decoded = HttpService:JSONDecode(data)
    return decoded
end

-- ğŸšª HÃ m teleport riÃªng cho World4
local function teleportWorld4()
    game:GetService("ReplicatedStorage"):WaitForChild("Network"):WaitForChild("World4Teleport"):InvokeServer()
    task.wait(180) -- chá» 3 phÃºt

    if game.PlaceId ~= PLACE_WORLD_4 then
        print("âš ï¸ Teleport World4 láº§n 1 tháº¥t báº¡i, thá»­ láº¡i...")
        game:GetService("ReplicatedStorage"):WaitForChild("Network"):WaitForChild("World4Teleport"):InvokeServer()
        task.wait(180)

        if game.PlaceId ~= PLACE_WORLD_4 then
            LocalPlayer:Kick("âš ï¸ Tele World4 tháº¥t báº¡i!")
        else
            print("âœ… Teleport World4 láº§n 2 thÃ nh cÃ´ng.")
        end
    else
        print("âœ… Teleport World4 láº§n 1 thÃ nh cÃ´ng.")
    end
end

-- ğŸ” Serverhop links (dÃ¹ng cho Farm/Fishing)
local function serverhopToFishing()
    local ok = false
    pcall(function()
        ok = loadstring(game:HttpGet("https://raw.githubusercontent.com/Hoith95/Pet-99/main/ServerHop-Event-Fish"))() or true
    end)
    return ok
end
local function serverhopToFarm()
    local ok = false
    pcall(function()
        ok = loadstring(game:HttpGet("https://raw.githubusercontent.com/Hoith95/Pet-99/main/ServerHop-Event-World"))() or true
    end)
    return ok
end

-- ğŸ§­ Logic chÃ­nh
task.spawn(function()
    local logData = readComboLog()
    if not logData then
        warn("âš ï¸ KhÃ´ng Ä‘á»c Ä‘Æ°á»£c file comboEventLog.json")
        return
    end

    local fishDone = (logData.fish and logData.fish.cotal or 0) >= 30
    local farmDone (logData.farm and logData.farm.total or 0) >= 30

    if fishDone and farmDone then
        -- âœ… Cáº£ 2 Ä‘Ã£ Ä‘á»§
        if game.PlaceId == PLACE_WORLD_4 then
            print("âœ… Äang á»Ÿ World4 vÃ  Ä‘Ã£ Ä‘á»§ Farm + Fishing â†’ Dá»«ng script.")
            return
        else
            print("â¡ï¸ Teleport qua World4...")
            teleportWorld4()
        end
    else
        -- â¸ ChÆ°a Ä‘á»§ 30p
        if game.PlaceId == PLACE_WORLD_4 then
            if not farmDone then
                print("â¡ï¸ Serverhop qua Farm...")
                serverhopToFarm()
            elseif not fishDone then
                print("â¡ï¸ Serverhop qua Fishing...")
                serverhopToFishing()
            else
                print("âš ï¸ TrÆ°á»ng há»£p báº¥t thÆ°á»ng: farmDone=", farmDone, " fishDone=", fishDone)
            end
        else
            print("â¸ ChÆ°a Ä‘á»§ 30p, nhÆ°ng khÃ´ng á»Ÿ World4 â†’ KhÃ´ng lÃ m gÃ¬.")
        end
    end
end)
