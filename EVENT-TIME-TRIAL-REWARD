if _G.VAR_TIME_TRIAL_REWARD then
	warn("â›” Script Ä‘Ã£ Ä‘Æ°á»£c cháº¡y trÆ°á»›c Ä‘Ã³!")
	return
end

_G.VAR_TIME_TRIAL_REWARD = true

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local Save = require(ReplicatedStorage:WaitForChild("Framework"):WaitForChild("Save"))

-- âš™ï¸ HÃ m láº¥y Ä‘iá»ƒm Time Trial
local function getTimeTrialPoints()
	local saveData = Save.Get()
	return saveData and saveData.TimeTrialStats and (saveData.TimeTrialStats.Points or 0) or 0
end

-- âš™ï¸ HÃ m láº¥y sá»‘ lÆ°á»£t Ä‘Ã£ dÃ¹ng
local function getRunsUsed()
	local saveData = Save.Get()
	return saveData and saveData.TimeTrialStats and (saveData.TimeTrialStats.DailyRuns or 0) or 0
end

-- âš™ï¸ Teleport Ä‘áº¿n vá»‹ trÃ­ Ä‘á»•i quÃ  (giá»¯ nguyÃªn nhÆ° báº¡n yÃªu cáº§u)
local function teleportToRewardLocation()
	game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-14223, 17.39, 1387)
end

-- âš™ï¸ HÃ m Ä‘á»•i quÃ  (giá»¯ nguyÃªn nhÆ° báº¡n yÃªu cáº§u)
local function openChest()
	local args = {
		[1] = 3
	}
	game:GetService("ReplicatedStorage").Network.TimeTrials_OpenChest:InvokeServer(unpack(args))
end

-- âœ… Báº®T Äáº¦U
warn("ğŸš€ Báº¯t Ä‘áº§u kiá»ƒm tra Time Trial...")

-- ğŸ“Œ Ghi láº¡i vá»‹ trÃ­ hiá»‡n táº¡i
local originalCFrame = character:WaitForChild("HumanoidRootPart").CFrame

-- â³ Äá»£i Ä‘áº¿n khi háº¿t lÆ°á»£t
while true do
	local runs = getRunsUsed()
	if runs >= 10 then
		warn("ğŸ“‰ ÄÃ£ dÃ¹ng háº¿t lÆ°á»£t Time Trial: " .. runs .. "/10")
		break
	end
	warn("âŒ› CÃ²n lÆ°á»£t Time Trial, Ä‘ang chá» háº¿t lÆ°á»£t... (" .. runs .. "/10)")
	task.wait(300) -- Äá»£i 5 phÃºt
end

-- ğŸ“Š Láº¥y Ä‘iá»ƒm hiá»‡n táº¡i
local points = getTimeTrialPoints()
warn("ğŸ’ Äiá»ƒm hiá»‡n táº¡i: " .. points)

-- ğŸ”¢ TÃ­nh sá»‘ láº§n cÃ³ thá»ƒ Ä‘á»•i
local chestCount = math.floor(points / 5000)
warn("ğŸ CÃ³ thá»ƒ Ä‘á»•i Ä‘Æ°á»£c " .. chestCount .. " pháº§n thÆ°á»Ÿng.")

if chestCount > 0 then
	-- ğŸ—ºï¸ Teleport Ä‘áº¿n chá»— Ä‘á»•i quÃ 
	teleportToRewardLocation()
	task.wait(2)

	-- ğŸ‰ Äá»•i quÃ 
	for i = 1, chestCount do
		local success, err = pcall(openChest)
		if success then
			warn("âœ… ÄÃ£ Ä‘á»•i pháº§n thÆ°á»Ÿng thá»© " .. i)
		else
			warn("âŒ Lá»—i khi Ä‘á»•i pháº§n thÆ°á»Ÿng " .. i .. ": " .. tostring(err))
		end
		task.wait(5)
	end
	task.wait(1)
else
	warn("âš ï¸ KhÃ´ng Ä‘á»§ Ä‘iá»ƒm Ä‘á»ƒ Ä‘á»•i pháº§n thÆ°á»Ÿng.")
end

-- ğŸ” Quay vá» vá»‹ trÃ­ ban Ä‘áº§u
character:WaitForChild("HumanoidRootPart").CFrame = originalCFrame
warn("ğŸ HoÃ n táº¥t quÃ¡ trÃ¬nh Ä‘á»•i quÃ  vÃ  Ä‘Ã£ trá»Ÿ vá» vá»‹ trÃ­ cÅ©.")
