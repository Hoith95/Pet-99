-- Kiểm tra biến toàn cục để xác định script đã chạy hay chưa
if _G.TELEEVFISH then
    warn("Script đã được chạy trước đó!")
    return
end

_G.TELEEVFISH = true

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local purchaseEvent = ReplicatedStorage.Network.EventBoatMerchant_Purchase
local spawnEvent = ReplicatedStorage.Network.Boats_RequestSpawn

-- Danh sách thuyền ưu tiên từ cao đến thấp
local boats = {"Boat 5", "Boat 4", "Boat 3", "Boat 2", "Boat 1"}

for _, boatName in ipairs(boats) do
    local success, result = pcall(function()
        return purchaseEvent:InvokeServer(boatName)
    end)

    if success and result == true then -- Kiểm tra mua thành công
        wait(1)
        spawnEvent:InvokeServer(boatName)
        print("Đã mua và gọi thuyền: " .. boatName)
        break -- Dừng lại sau khi đã thành công với loại cao nhất có thể
    else
        print("Không thể mua: " .. boatName)
    end
end

wait(1)

-- Danh sách vị trí gốc
local basePositions = {
    Vector3.new(11728, 4.16, 212),
    Vector3.new(12339, 4.16, 456),
    Vector3.new(12786, 4.16, -377),
    Vector3.new(11974, 4.16, -159)
}

-- Hàm thay chữ số cuối cùng bằng số ngẫu nhiên từ 1 đến 9
local function replaceLastDigit(value)
    local prefix = math.floor(value / 10) * 10
    local newDigit = math.random(1, 9)
    return prefix + newDigit
end

-- Chọn vị trí và chỉnh sửa trục X, Z
local basePos = basePositions[math.random(1, #basePositions)]
local finalX = replaceLastDigit(basePos.X)
local finalY = 4.16 -- giữ nguyên
local finalZ = replaceLastDigit(basePos.Z)

-- Dịch chuyển
local finalPosition = CFrame.new(finalX, finalY, finalZ)
game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = finalPosition
