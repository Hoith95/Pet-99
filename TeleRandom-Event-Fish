-- Ki·ªÉm tra bi·∫øn to√†n c·ª•c ƒë·ªÉ x√°c ƒë·ªãnh script ƒë√£ ch·∫°y hay ch∆∞a
if _G.TELEEVFISH then
    warn("Script ƒë√£ ƒë∆∞·ª£c ch·∫°y tr∆∞·ªõc ƒë√≥!")
    return
end

_G.TELEEVFISH = true

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local purchaseEvent = ReplicatedStorage.Network.EventBoatMerchant_Purchase
local spawnEvent = ReplicatedStorage.Network.Boats_RequestSpawn

local boats = {"Boat 5", "Boat 4", "Boat 3", "Boat 2", "Boat 1"}
local spawned = false

-- Th·ª≠ mua v√† g·ªçi thuy·ªÅn t·ª´ cao xu·ªëng th·∫•p
for _, boatName in ipairs(boats) do
    local success, result = pcall(function()
        return purchaseEvent:InvokeServer(boatName)
    end)

    if success and result == true then
        wait(1)
        spawnEvent:InvokeServer(boatName)
        print("‚úÖ ƒê√£ mua v√† g·ªçi thuy·ªÅn: " .. boatName)
        spawned = true
        break
    else
        print("‚ö†Ô∏è Kh√¥ng th·ªÉ mua: " .. boatName)
    end
end

-- N·∫øu kh√¥ng mua ƒë∆∞·ª£c c√°i n√†o, g·ªçi Boat 1 nh∆∞ l·ª±a ch·ªçn cu·ªëi
if not spawned then
    local success = pcall(function()
        spawnEvent:InvokeServer("Boat 1")
    end)
    if success then
        print("üö¢ G·ªçi Boat 1 v√¨ kh√¥ng mua ƒë∆∞·ª£c thuy·ªÅn n√†o")
    else
        warn("‚ùå Kh√¥ng th·ªÉ g·ªçi Boat 1")
    end
end

wait(1)

-- Danh s√°ch v·ªã tr√≠ g·ªëc
local basePositions = {
    Vector3.new(11728, 4.16, 212),
    Vector3.new(12339, 4.16, 456),
    Vector3.new(12786, 4.16, -377),
    Vector3.new(11974, 4.16, -159)
}

-- H√†m thay ch·ªØ s·ªë cu·ªëi c√πng b·∫±ng s·ªë ng·∫´u nhi√™n t·ª´ 1 ƒë·∫øn 9
local function replaceLastDigit(value)
    local prefix = math.floor(value / 10) * 10
    local newDigit = math.random(1, 9)
    return prefix + newDigit
end

-- Ch·ªçn v·ªã tr√≠ v√† ch·ªânh s·ª≠a tr·ª•c X, Z
local basePos = basePositions[math.random(1, #basePositions)]
local finalX = replaceLastDigit(basePos.X)
local finalY = 4.16 -- gi·ªØ nguy√™n
local finalZ = replaceLastDigit(basePos.Z)

-- D·ªãch chuy·ªÉn
local finalPosition = CFrame.new(finalX, finalY, finalZ)
game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = finalPosition
