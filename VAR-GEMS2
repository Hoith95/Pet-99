-- Kiểm tra biến toàn cục để xác định script đã chạy hay chưa
if _G.VARGEMS then
    warn("Script đã được chạy trước đó!")
    return -- Dừng script nếu đã chạy
end

-- Đánh dấu script đã được chạy
_G.VARGEMS = true

-- Lấy dịch vụ Players
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local leaderstats = LocalPlayer:WaitForChild("leaderstats")
local diamondStat = leaderstats:WaitForChild("💎 Diamonds")
local function inHalloweenWorld()
	local c = workspace:FindFirstChild("__THINGS") and workspace.__THINGS:FindFirstChild("__INSTANCE_CONTAINER")
	return c and c:FindFirstChild("Active") and c.Active:FindFirstChild("HalloweenWorld")
end

repeat task.wait(1) until inHalloweenWorld()

-- Ngưỡng tăng kim cương tối thiểu để không ServerHop
local MIN_GAIN = 1680000

-- Hàm kiểm tra kim cương định kỳ
local function monitorDiamonds()
    while true do
        -- Lấy giá trị ban đầu
        local initialDiamonds = diamondStat.Value
        print("💠 Số kim cương ban đầu: " .. initialDiamonds)

        -- Chờ 10 phút (600 giây)
        task.wait(600)

        -- Lấy giá trị hiện tại
        local currentDiamonds = diamondStat.Value
        local diff = currentDiamonds - initialDiamonds

        print(string.format("📊 Sau 10 phút: hiện có %d (tăng %d)", currentDiamonds, diff))

        -- Kiểm tra chênh lệch
        if diff < MIN_GAIN then
            print("⚠️ Kim cương tăng dưới " .. MIN_GAIN .. " → Thực hiện ServerHop.")
            game.Players.LocalPlayer:Kick("Heo VAR")
            return -- Dừng vòng hiện tại, script JoinLow sẽ tự chạy lại
        else
            print("✅ Kim cương tăng đủ (" .. diff .. "), không ServerHop. Tiếp tục theo dõi...")
        end
    end
end

-- Chạy kiểm tra
monitorDiamonds()
