loadstring(game:HttpGet("https://raw.githubusercontent.com/Hoith95/Pet-99/main/WaitForGameLoad"))()

local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local Player = game:GetService("Players").LocalPlayer

local function teleportToLeastPopulatedServer(placeId, retryLimit)
    retryLimit = retryLimit or 5
    local attempts = 0
    local minPlayers = 1

    while attempts < retryLimit do
        attempts += 1
        local success, result = pcall(function()
            return HttpService:JSONDecode(game:HttpGet('https://games.roblox.com/v1/games/' .. placeId .. '/servers/Public?sortOrder=Asc&limit=100&excludeFullServers=true')).data
        end)

        if success and result and #result > 2 then
            local validServers = {}
            for _, server in ipairs(result) do
                if server.playing >= minPlayers and server.playing < server.maxPlayers then
                    table.insert(validServers, server)
                end
            end

            if #validServers > 2 then
                -- Bỏ qua 2 server đầu tiên và chọn server có ít người nhất từ phần còn lại
                table.sort(validServers, function(a, b)
                    return a.playing < b.playing
                end)

                local selectedServer = validServers[3]  -- Bắt đầu từ server thứ 3 sau khi sort theo số người ít

                local teleportSuccess, teleportError = pcall(function()
                    TeleportService:TeleportToPlaceInstance(placeId, selectedServer.id, Player)
                end)

                if teleportSuccess then
                    print("Teleport thành công đến server:", selectedServer.id)
                    return true
                else
                    warn("Teleport thất bại, thử lại... (Lỗi: " .. tostring(teleportError) .. ")")
                end
            else
                print("Không đủ server hợp lệ để chọn từ server thứ 3.")
            end
        else
            warn("Không thể lấy danh sách server hợp lệ! Thử lại lần " .. attempts)
        end

        task.wait(5)
    end

    warn("Không thể teleport sau " .. retryLimit .. " lần thử!")
    return false
end

-- Kiểm tra số lượng người chơi hiện tại
local currentPlayerCount = #game:GetService("Players"):GetPlayers()

if currentPlayerCount <= 1 or currentPlayerCount > 5 then
    task.wait(3)
    teleportToLeastPopulatedServer(95635359880599, 25)
else
    print("Số lượng người chơi hiện tại từ 2 đến 5. Không chạy script.")
end
